<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Calculadora Online - React</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    :root {

      --bg-color: #ffffff;
      --text-color: #000000;
      --btn-bg: #f0f0f0;
      --btn-hover: #e0e0e0;
      --accent: #007bff;
    }

    .dark {
      --bg-color: #1e1e1e;
      --text-color: #ffffff;
      --btn-bg: #333333;
      --btn-hover: #444444;
      --accent: #0d6efd;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 40px 20px;
      min-height: 100vh;
      transition: background-color 0.3s, color 0.3s;
      position: relative;
      overflow-x: hidden;
    }

    /* Fundo animado */
    .animated-background {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
    }

    .particle {
      position: absolute;
      border-radius: 50%;
      animation: float 6s ease-in-out infinite;
      opacity: 0.7;
    }

    .particle:nth-child(1) {
      width: 80px;
      height: 80px;
      background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
      top: 20%;
      left: 10%;
      animation-delay: 0s;
      animation-duration: 8s;
    }

    .particle:nth-child(2) {
      width: 60px;
      height: 60px;
      background: linear-gradient(45deg, #4ecdc4, #6ed5cd);
      top: 60%;
      left: 80%;
      animation-delay: 2s;
      animation-duration: 10s;
    }

    .particle:nth-child(3) {
      width: 100px;
      height: 100px;
      background: linear-gradient(45deg, #45b7d1, #6bc5d8);
      top: 30%;
      left: 70%;
      animation-delay: 4s;
      animation-duration: 12s;
    }

    .particle:nth-child(4) {
      width: 40px;
      height: 40px;
      background: linear-gradient(45deg, #96ceb4, #a8d5c0);
      top: 80%;
      left: 20%;
      animation-delay: 1s;
      animation-duration: 7s;
    }

    .particle:nth-child(5) {
      width: 70px;
      height: 70px;
      background: linear-gradient(45deg, #feca57, #fed976);
      top: 10%;
      left: 50%;
      animation-delay: 3s;
      animation-duration: 9s;
    }

    .particle:nth-child(6) {
      width: 50px;
      height: 50px;
      background: linear-gradient(45deg, #ff9ff3, #f368e0);
      top: 70%;
      left: 40%;
      animation-delay: 5s;
      animation-duration: 11s;
    }

    .particle:nth-child(7) {
      width: 30px;
      height: 30px;
      background: linear-gradient(45deg, #a55eea, #b77eea);
      top: 40%;
      left: 15%;
      animation-delay: 1.5s;
      animation-duration: 6s;
    }

    .particle:nth-child(8) {
      width: 90px;
      height: 90px;
      background: linear-gradient(45deg, #26de81, #4ade8a);
      top: 50%;
      left: 60%;
      animation-delay: 3.5s;
      animation-duration: 13s;
    }

    .particle:nth-child(9) {
      width: 35px;
      height: 35px;
      background: linear-gradient(45deg, #fd79a8, #fdcb6e);
      top: 15%;
      left: 85%;
      animation-delay: 2.5s;
      animation-duration: 8.5s;
    }

    .particle:nth-child(10) {
      width: 65px;
      height: 65px;
      background: linear-gradient(45deg, #6c5ce7, #a29bfe);
      top: 75%;
      left: 5%;
      animation-delay: 4.5s;
      animation-duration: 9.5s;
    }

    /* Modo escuro - cores mais escuras */
    .dark .particle:nth-child(1) {
      background: linear-gradient(45deg, #2c3e50, #34495e);
    }

    .dark .particle:nth-child(2) {
      background: linear-gradient(45deg, #1a252f, #2c3e50);
    }

    .dark .particle:nth-child(3) {
      background: linear-gradient(45deg, #34495e, #2c3e50);
    }

    .dark .particle:nth-child(4) {
      background: linear-gradient(45deg, #2c3e50, #34495e);
    }

    .dark .particle:nth-child(5) {
      background: linear-gradient(45deg, #1a252f, #2c3e50);
    }

    .dark .particle:nth-child(6) {
      background: linear-gradient(45deg, #34495e, #2c3e50);
    }

    .dark .particle:nth-child(7) {
      background: linear-gradient(45deg, #1a252f, #2c3e50);
    }

    .dark .particle:nth-child(8) {
      background: linear-gradient(45deg, #2c3e50, #34495e);
    }

    .dark .particle:nth-child(9) {
      background: linear-gradient(45deg, #34495e, #2c3e50);
    }

    .dark .particle:nth-child(10) {
      background: linear-gradient(45deg, #1a252f, #2c3e50);
    }

    @keyframes float {
      0%, 100% {
        transform: translateY(0px) rotate(0deg);
        opacity: 0.7;
      }
      25% {
        transform: translateY(-20px) rotate(90deg);
        opacity: 1;
      }
      50% {
        transform: translateY(-40px) rotate(180deg);
        opacity: 0.8;
      }
      75% {
        transform: translateY(-20px) rotate(270deg);
        opacity: 1;
      }
    }

    /* Efeito de ondas */
    .wave {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 100px;
      background: linear-gradient(45deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
      animation: wave 4s ease-in-out infinite;
    }

    .dark .wave {
      background: linear-gradient(45deg, rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.05));
    }

    @keyframes wave {
      0%, 100% {
        transform: translateX(0) scaleY(1);
      }
      50% {
        transform: translateX(-25%) scaleY(1.1);
      }
    }

    .container {
      width: 100%;
      max-width: 500px;
    }

    .calculator {
      background: var(--bg-color);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 30px rgba(0,0,0,0.2);
      transition: background-color 0.3s;
      position: relative;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .dark .calculator {
      border: 1px solid rgba(255, 255, 255, 0.05);
      box-shadow: 0 0 30px rgba(0,0,0,0.5);
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .mode-indicator {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .mode-toggle {
      background: var(--accent);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 20px;
      cursor: pointer;
      font-size: 14px;
      font-weight: bold;
      transition: all 0.3s;
    }

    .mode-toggle:hover {
      background: #0056b3;
    }

    .mode-toggle.active {
      background: #28a745;
    }

    .mode-label {
      font-size: 12px;
      font-weight: bold;
      color: var(--text-color);
      opacity: 0.7;
    }

    #toggle-theme {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: var(--text-color);
    }

    #display {
      width: 100%;
      height: 50px;
      font-size: 28px;
      text-align: right;
      padding: 10px;
      margin-bottom: 15px;
      border: 2px solid var(--accent);
      border-radius: 6px;
      background: var(--btn-bg);
      color: var(--text-color);
    }

    .buttons {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
    }

    .scientific-buttons {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 8px;
      margin-bottom: 10px;
    }

    .scientific-buttons button {
      padding: 10px;
      font-size: 14px;
    }

    .normal-buttons {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
    }

    button {
      padding: 15px;
      font-size: 20px;
      cursor: pointer;
      background-color: var(--btn-bg);
      color: var(--text-color);
      border: 1px solid #ccc;
      border-radius: 6px;
      transition: background-color 0.2s;
    }

    button:hover {
      background-color: var(--btn-hover);
    }

    #clear {
      background-color: var(--accent);
      color: white;
    }

    #equals {
      grid-column: span 4;
      background-color: #28a745;
      color: white;
    }

    .scientific-btn {
      background-color: #6c757d;
      color: white;
      font-size: 12px;
    }

    .scientific-btn:hover {
      background-color: #5a6268;
    }

    .function-btn {
      background-color: #17a2b8;
      color: white;
    }

    .function-btn:hover {
      background-color: #138496;
    }

    .history {
      margin-top: 20px;
      transition: all 0.3s ease;
    }

    .history-highlight {
      background-color: rgba(0, 123, 255, 0.1);
      border-radius: 8px;
      padding: 10px;
      border: 2px solid rgba(0, 123, 255, 0.3);
      animation: historyPulse 0.5s ease-out;
    }

    .dark .history-highlight {
      background-color: rgba(0, 123, 255, 0.2);
      border-color: rgba(0, 123, 255, 0.5);
    }

    @keyframes historyPulse {
      0% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(0, 123, 255, 0.4);
      }
      50% {
        transform: scale(1.02);
        box-shadow: 0 0 0 10px rgba(0, 123, 255, 0.1);
      }
      100% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(0, 123, 255, 0);
      }
    }

    .history h3 {
      margin-bottom: 10px;
      color: var(--text-color);
    }

    #history-list {
      list-style: none;
      padding: 0;
      max-height: 150px;
      overflow-y: auto;
      font-size: 14px;
    }

    #history-list li {
      padding: 5px 0;
      border-bottom: 1px solid #ccc;
      transition: all 0.3s ease;
      color: var(--text-color);
    }

    .dark #history-list li {
      border-bottom-color: #555;
    }

    .history-item-new {
      background-color: #d4edda;
      color: #155724;
      border-radius: 4px;
      padding: 8px;
      margin: 2px 0;
      border-left: 4px solid #28a745;
      animation: highlightNew 1s ease-out;
    }

    .dark .history-item-new {
      background-color: #1e4d2b;
      color: #d4edda;
      border-left-color: #28a745;
      animation: highlightNewDark 1s ease-out;
    }

    @keyframes highlightNew {
      0% {
        background-color: #ffc107;
        transform: scale(1.05);
      }
      50% {
        background-color: #17a2b8;
        transform: scale(1.02);
      }
      100% {
        background-color: #d4edda;
        transform: scale(1);
      }
    }

    @keyframes highlightNewDark {
      0% {
        background-color: #ffc107;
        transform: scale(1.05);
      }
      50% {
        background-color: #17a2b8;
        transform: scale(1.02);
      }
      100% {
        background-color: #1e4d2b;
        transform: scale(1);
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    const Calculator = () => {
      const [display, setDisplay] = useState('');
      const [history, setHistory] = useState([]);
      const [isDarkMode, setIsDarkMode] = useState(false);
      const [isScientificMode, setIsScientificMode] = useState(false);
      const [newHistoryItem, setNewHistoryItem] = useState(null);
      const [displayChanged, setDisplayChanged] = useState(false);

      const addToHistory = (expression, result) => {
        const newItem = { expression, result, id: Date.now() };
        setHistory(prev => [newItem, ...prev]);
        setNewHistoryItem(newItem.id);
        
        // Remove o destaque após a animação
        setTimeout(() => {
          setNewHistoryItem(null);
        }, 1000);
      };

      const calculate = () => {
        try {
          const result = eval(display);
          addToHistory(display, result);
          setDisplay(result.toString());
        } catch {
          setDisplay('Erro');
        }
      };

      const scientificFunctions = {
        'sin': (x) => Math.sin(x * Math.PI / 180),
        'cos': (x) => Math.cos(x * Math.PI / 180),
        'tan': (x) => Math.tan(x * Math.PI / 180),
        'log': (x) => Math.log10(x),
        'ln': (x) => Math.log(x),
        'sqrt': (x) => Math.sqrt(x),
        'pow2': (x) => Math.pow(x, 2),
        'pow3': (x) => Math.pow(x, 3),
        'exp': (x) => Math.exp(x),
        'pi': () => Math.PI,
        'e': () => Math.E,
        'fact': (x) => {
          if (x < 0) return NaN;
          if (x === 0 || x === 1) return 1;
          let result = 1;
          for (let i = 2; i <= x; i++) {
            result *= i;
          }
          return result;
        }
      };

      const handleScientificFunction = (func) => {
        try {
          const currentValue = parseFloat(display) || 0;
          let result;
          
          if (func === 'pi' || func === 'e') {
            result = scientificFunctions[func]();
          } else {
            result = scientificFunctions[func](currentValue);
          }
          
          addToHistory(`${func}(${currentValue})`, result);
          setDisplay(result.toString());
        } catch {
          setDisplay('Erro');
        }
      };

      const handleButtonClick = (value) => {
        if (value === '=') {
          calculate();
        } else if (value === 'C') {
          setDisplay('');
        } else if (value === 'toggle-theme') {
          setIsDarkMode(!isDarkMode);
        } else if (value === 'toggle-mode') {
          setIsScientificMode(!isScientificMode);
        } else if (scientificFunctions[value]) {
          handleScientificFunction(value);
        } else {
          if (display && !isNaN(display) && '+-*/'.includes(value)) {
            setDisplay(display + value);
          } else {
            setDisplay(prev => prev + value);
          }
        }
      };

      const handleKeyPress = (e) => {
        const validKeys = '0123456789+-*/';
        if (validKeys.includes(e.key)) {
          if (display && !isNaN(display) && '+-*/'.includes(e.key)) {
            setDisplay(display + e.key);
          } else {
            setDisplay(prev => prev + e.key);
          }
        } else if (e.key === 'Enter') {
          calculate();
        } else if (e.key === 'Backspace') {
          setDisplay(prev => prev.slice(0, -1));
        } else if (e.key === 'Escape') {
          setDisplay('');
        }
      };

      useEffect(() => {
        document.addEventListener('keydown', handleKeyPress);
        return () => {
          document.removeEventListener('keydown', handleKeyPress);
        };
      }, [display]);

      // Efeito para destacar histórico quando display muda
      useEffect(() => {
        if (display !== '') {
          setDisplayChanged(true);
          const timer = setTimeout(() => {
            setDisplayChanged(false);
          }, 500);
          return () => clearTimeout(timer);
        }
      }, [display]);

      const scientificButtons = [
        { value: 'sin', class: 'scientific-btn' }, { value: 'cos', class: 'scientific-btn' }, 
        { value: 'tan', class: 'scientific-btn' }, { value: 'log', class: 'scientific-btn' }, 
        { value: 'ln', class: 'scientific-btn' },
        { value: 'sqrt', class: 'function-btn' }, { value: 'pow2', class: 'function-btn' }, 
        { value: 'pow3', class: 'function-btn' }, { value: 'exp', class: 'function-btn' }, 
        { value: 'fact', class: 'function-btn' },
        { value: 'pi', class: 'scientific-btn' }, { value: 'e', class: 'scientific-btn' }
      ];

      const normalButtons = [
        { value: '7' }, { value: '8' }, { value: '9' }, { value: 'C', id: 'clear' },
        { value: '4' }, { value: '5' }, { value: '6' }, { value: '/' },
        { value: '1' }, { value: '2' }, { value: '3' }, { value: '*' },
        { value: '0' }, { value: '.' }, { value: '+' }, { value: '-' },
        { value: '=', id: 'equals' }
      ];

      return (
        <div className={`container ${isDarkMode ? 'dark' : ''}`}>
          {/* Fundo animado */}
          <div className="animated-background">
            <div className="particle"></div>
            <div className="particle"></div>
            <div className="particle"></div>
            <div className="particle"></div>
            <div className="particle"></div>
            <div className="particle"></div>
            <div className="particle"></div>
            <div className="particle"></div>
            <div className="particle"></div>
            <div className="particle"></div>
            <div className="wave"></div>
          </div>
          
          <div className="calculator">
            <div className="top-bar">
              <div className="mode-indicator">
                <span className="mode-label">Modo:</span>
                <button 
                  className={`mode-toggle ${isScientificMode ? 'active' : ''}`}
                  onClick={() => handleButtonClick('toggle-mode')}
                >
                  {isScientificMode ? 'Científico' : 'Normal'}
                </button>
              </div>
              <button 
                id="toggle-theme" 
                onClick={() => handleButtonClick('toggle-theme')}
              >
                {isDarkMode ? '☀️' : '🌙'}
              </button>
            </div>
            
            <input 
              type="text" 
              id="display" 
              value={display}
              disabled 
            />
            
            {isScientificMode && (
              <div className="scientific-buttons">
                {scientificButtons.map((button, index) => (
                  <button
                    key={index}
                    className={button.class}
                    onClick={() => handleButtonClick(button.value)}
                  >
                    {button.value}
                  </button>
                ))}
      </div>
            )}
            
            <div className="normal-buttons">
              {normalButtons.map((button, index) => (
                <button
                  key={index}
                  id={button.id}
                  onClick={() => handleButtonClick(button.value)}
                >
                  {button.value}
                </button>
              ))}
      </div>
            
            <div className={`history ${displayChanged ? 'history-highlight' : ''}`}>
        <h3>Histórico</h3>
              <ul id="history-list">
                {history.map((item, index) => (
                  <li 
                    key={item.id || index}
                    className={newHistoryItem === item.id ? 'history-item-new' : ''}
                  >
                    {item.expression} = {item.result}
                  </li>
                ))}
              </ul>
      </div>
    </div>
  </div>
      );
    };

    const App = () => {
      return <Calculator />;
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
